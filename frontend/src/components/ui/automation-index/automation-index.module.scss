:root {
    --trigger-color: #d28200; // Light mode : orange
    --border-automation: #5bab98;
}

html:is([class*="dark"]) {
    --trigger-color: #d0ad32; // Dark mode : jaune orangé
    --border-automation: #116053; 
}

@keyframes dialogIn {
    from {
        opacity: 0;
        transform: translate(0%, -2%) scale(0.95);
    }

    to {
        opacity: 1;
        transform: translate(0%, 0%) scale(1);
    }
}

@keyframes dialogOut {
    from {
        opacity: 1;
        transform: translate(0%, 0%) scale(1);
    }

    to {
        opacity: 0;
        transform: translate(0%, -2%) scale(0.95);
    }
}

.automation {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: var(--spacing-8);
    grid-column: span 12;
    margin-block: auto;
    min-height: 400px;
    isolation: isolate;
    position: relative;
    // overflow: hidden;
    flex: 1;
    padding-top: 0;
    padding-bottom: var(--spacing-32);
    height: 100%;

    &[data-state="open"] {
        animation: dialogIn 0.2s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    }

    &[data-state="closed"] {
        animation: dialogOut 0.2s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        pointer-events: none;
    }
}

.automationBackground {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    width: 600px;
    height: 1000px;
    margin: auto;
    pointer-events: none;
    opacity: 0.1;
    filter: blur(0px) saturate(1.5);
    transform: scale(2.8) translateX(-34px);
    z-index: -1;

    line {
        stroke-width: 0.3px;
    }

    >* {
        stroke: orange;
        rotate: 135deg;
        transform-origin: center;
        fill: orange;

        >rect {
            width: 6px;
            height: 5px;
            filter: hue-rotate(484deg);
            opacity: 1;
            transform: translateX(-1px);
        }
    }
}

.automationContent {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--spacing-10);
    position: relative;
    z-index: 1;
    background: var(--automation-content-bg);
    box-shadow: var(--automation-content-shadow);
    min-width: min(100vw - var(--spacing-10) * 2, 820px);
}

.automationIcon {
    // stroke: var(--text-primary);
    // fill: var(--surface-primary-soft);
    stroke: var(--trigger-color);
}

.automationText {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--spacing-3);
}

.automationTitle {
    font-weight: 500;
    color: var(--text-minus-1);
    margin: 0;
    font-family: var(--font-brand) !important;
    font-size: 2.5rem;
    // line-height: 1.2;
    font-weight: bold;

    * {
        font-family: var(--font-brand) !important;
    }
}

.automationTitleHighlight {
    color: var(--text-primary);

    background: linear-gradient(90deg, #c5bd74 0%, #c5bd74 100%);
    -webkit-background-clip: text;
    background-clip: text;
    font-weight: 600;
}

.automationDescription {
    color: var(--text-2);
    font-size: var(--text-base);
    line-height: var(--text-base--line-height);
    margin: 0;
}

.automationFormContainer {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-8);
    width: 100%;
    margin: auto;
    display: flex;
    gap: var(--spacing-8);
    min-width: min(100vw - var(--spacing-10) * 2, 500px);
    background-color: var(--surface-2);

    --border-width: 0px;

    --glow-deg: 10deg;
    // --gradient-glow: rgb(11, 94, 154), rgb(56, 162, 168), rgb(56, 162, 168), rgb(56, 162, 168), rgb(56, 162, 168), rgb(0, 187, 255), rgb(56, 162, 168);

    // Dark mode OK




    transition: max-height 0.3s ease-in-out;
    border: var(--border-width) solid transparent;
    border-radius: var(--radius-2xl);
    position: relative;
    isolation: isolate;
    flex-direction: column;
    padding-inline: 0;
    border: 1px solid var(--polygon-sidebar-border);


    &::before,
    &::after {
        content: '';
        position: absolute;
        border-radius: inherit;
    }

    &::before {
        pointer-events: none;
        position: absolute;
        bottom: -16rem;
        top: 1rem;
        // background: linear-gradient(to top, #0097ff69);
        // background: linear-gradient(to top, rgb(106 107 17 / 23%));
        background: conic-gradient(from var(--glow-deg), var(--gradient-glow));
        opacity: 0.085;
        filter: blur(3rem);
        border-radius: 0;
        transform: unset;
        transform-origin: center;
        height: 100%;;
        width: 100%;
        left: 0;
        right: 0;
        max-width: unset;
        top: 0.5rem;
        opacity: 0.3;
        filter: blur(2rem);
        border-radius: 100% 85%;
        height: 100%;
        width: 100%;
        z-index: -1;
    }

    &::after {
        position: absolute;
        background: transparent;
        z-index: -1;
        inset: -1px;
        opacity: 1;
    }
}

.automationFormContainerActions {
    display: flex;
    align-items: flex-end;
    gap: var(--spacing-2);
    justify-content: center;
    flex-direction: row-reverse;
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: var(--spacing-4);
}

.automationFormContainerActionsIcons {
    display: flex;
    align-items: center;
    gap: var(--spacing-2);
}

.textareaContainer {
    position: relative;
    display: flex;
    align-items: stretch;
    width: 100%;
}

.automationTextarea {
    min-height: 120px;
    background-color: var(--home-textarea-bg);
    font-size: var(--text-base);
    border: 0;
    border-radius: var(--radius-2xl);
    padding: var(--spacing-6) !important;
    width: 100%;
    transition: box-shadow 0.2s ease-in-out;
    resize: none;
    font-family: var(--font-brand);
    line-height: 1.6;
    border: 0 !important;
    border-radius: var(--radius-2xl) !important;
    box-shadow: unset !important;
    padding-bottom: 70px !important;

    &:focus {
        outline: 2px solid var(--border-automation);
        outline-offset: 2px;
    }

    &::placeholder {
        color: var(--text-3);
        font-style: italic;
    }
}

.submitButton {
    margin-left: auto;
}

button:hover .buttonIconRight {
    transform: translateX(2px);
    stroke: #000d09;
}


.buttonIconLeft {
    margin-right: var(--spacing-2);
}

.buttonIconRight {
    transition: transform 0.2s ease-in-out;
}

// ==========================================
// DIAGRAMME DE FLUX COMPLEXE
// ==========================================

// Ligne principale
.mainLine {
    stroke: var(--border-primary);
    stroke-width: 1;
    opacity: 0.15;
}

// Toutes les branches
.branch1,
.branch2,
.branch3,
.branch4,
.branch5,
.branch6,
.branch7,
.branch8,
.branch9,
.branch10,
.branch11,
.branch12,
.branch13,
.branch14,
.branch15,
.branch16,
.branch17,
.branch18,
.branch19,
.branch20,
.branch21,
.branch22,
.branch23,
.branch24,
.branch25,
.branch26,
.branch27,
.branch28,
.branch29,
.branch30,
.branch31,
.branch32,
.branch33,
.branch34,
.branch35,
.branch36,
.branch37,
.branch38,
.branch39,
.branch40,
.branch41,
.branch42,
.branch43,
.branch44,
.branch45,
.branch46,
.branch47 {
    stroke: var(--border-primary);
    stroke-width: 1;
    opacity: 0;
    stroke-dasharray: 100;
    stroke-dashoffset: 100;
}

// Premier split triple (simultané)
.branch1 {
    animation: drawBranch 0.25s ease-out forwards;
    animation-delay: 0.05s;
}

.branch2 {
    animation: drawBranch 0.25s ease-out forwards;
    animation-delay: 0.05s;
}

.branch3 {
    animation: drawBranch 0.25s ease-out forwards;
    animation-delay: 0.05s;
}

// Voie haute - niveau 2
.branch4 {
    animation: drawBranch 0.25s ease-out forwards;
    animation-delay: 0.3s;
}

.branch5 {
    animation: drawBranch 0.2s ease-out forwards;
    animation-delay: 0.55s;
}

.branch6 {
    animation: drawBranch 0.2s ease-out forwards;
    animation-delay: 0.55s;
}

// Voie haute - niveau 3
.branch7 {
    animation: drawBranch 0.2s ease-out forwards;
    animation-delay: 0.75s;
}

.branch8 {
    animation: drawBranch 0.2s ease-out forwards;
    animation-delay: 0.75s;
}

// Triple split haute
.branch9 {
    animation: drawBranch 0.15s ease-out forwards;
    animation-delay: 0.95s;
}

.branch10 {
    animation: drawBranch 0.15s ease-out forwards;
    animation-delay: 0.95s;
}

.branch11 {
    animation: drawBranch 0.15s ease-out forwards;
    animation-delay: 0.95s;
}

.branch12 {
    animation: drawBranch 0.15s ease-out forwards;
    animation-delay: 1.1s;
}

.branch13 {
    animation: drawBranch 0.15s ease-out forwards;
    animation-delay: 1.1s;
}

.branch14 {
    animation: drawBranch 0.15s ease-out forwards;
    animation-delay: 1.25s;
}

.branch15 {
    animation: drawBranch 0.15s ease-out forwards;
    animation-delay: 1.25s;
}

// Convergence voie haute
.branch16 {
    animation: drawBranch 0.2s ease-out forwards;
    animation-delay: 1.4s;
}

.branch17 {
    animation: drawBranch 0.15s ease-out forwards;
    animation-delay: 1.6s;
}

.branch18 {
    animation: drawBranch 0.25s ease-out forwards;
    animation-delay: 1.75s;
}

// Voie milieu
.branch19 {
    animation: drawBranch 0.25s ease-out forwards;
    animation-delay: 0.3s;
}

.branch20 {
    animation: drawBranch 0.2s ease-out forwards;
    animation-delay: 0.55s;
}

.branch21 {
    animation: drawBranch 0.2s ease-out forwards;
    animation-delay: 0.55s;
}

.branch22 {
    animation: drawBranch 0.25s ease-out forwards;
    animation-delay: 0.75s;
}

.branch23 {
    animation: drawBranch 0.25s ease-out forwards;
    animation-delay: 0.75s;
}

.branch24 {
    animation: drawBranch 0.25s ease-out forwards;
    animation-delay: 1s;
}

.branch25 {
    animation: drawBranch 0.25s ease-out forwards;
    animation-delay: 1s;
}

// Voie basse - niveau 2
.branch26 {
    animation: drawBranch 0.25s ease-out forwards;
    animation-delay: 0.3s;
}

.branch27 {
    animation: drawBranch 0.2s ease-out forwards;
    animation-delay: 0.55s;
}

.branch28 {
    animation: drawBranch 0.2s ease-out forwards;
    animation-delay: 0.55s;
}

// Voie basse - niveau 3
.branch29 {
    animation: drawBranch 0.2s ease-out forwards;
    animation-delay: 0.75s;
}

.branch30 {
    animation: drawBranch 0.2s ease-out forwards;
    animation-delay: 0.75s;
}

// Triple split basse
.branch31 {
    animation: drawBranch 0.15s ease-out forwards;
    animation-delay: 0.95s;
}

.branch32 {
    animation: drawBranch 0.15s ease-out forwards;
    animation-delay: 0.95s;
}

.branch33 {
    animation: drawBranch 0.15s ease-out forwards;
    animation-delay: 0.95s;
}

.branch34 {
    animation: drawBranch 0.15s ease-out forwards;
    animation-delay: 1.1s;
}

.branch35 {
    animation: drawBranch 0.15s ease-out forwards;
    animation-delay: 1.1s;
}

.branch36 {
    animation: drawBranch 0.15s ease-out forwards;
    animation-delay: 1.25s;
}

.branch37 {
    animation: drawBranch 0.15s ease-out forwards;
    animation-delay: 1.25s;
}

// Convergence voie basse
.branch38 {
    animation: drawBranch 0.2s ease-out forwards;
    animation-delay: 1.4s;
}

.branch39 {
    animation: drawBranch 0.15s ease-out forwards;
    animation-delay: 1.6s;
}

.branch40 {
    animation: drawBranch 0.25s ease-out forwards;
    animation-delay: 1.75s;
}

// Convergence finale
.branch41 {
    animation: drawBranch 0.2s ease-out forwards;
    animation-delay: 2s;
}

.branch42 {
    animation: drawBranch 0.2s ease-out forwards;
    animation-delay: 2s;
}

.branch43 {
    animation: drawBranch 0.2s ease-out forwards;
    animation-delay: 2.2s;
}

.branch44 {
    animation: drawBranch 0.2s ease-out forwards;
    animation-delay: 2.2s;
}

.branch45 {
    animation: drawBranch 0.15s ease-out forwards;
    animation-delay: 2.4s;
}

.branch46 {
    animation: drawBranch 0.15s ease-out forwards;
    animation-delay: 2.4s;
}

.branch47 {
    animation: drawBranch 0.2s ease-out forwards;
    animation-delay: 2.55s;
}

// Tous les nœuds (hexagones)
.node1,
.node2,
.node3,
.node4,
.node5,
.node6,
.node7,
.node8,
.node9,
.node10,
.node11,
.node12,
.node13,
.node14,
.node15,
.node16,
.node17,
.node18,
.node19,
.node20,
.node21,
.node22,
.node23,
.node24 {
    opacity: 0;

    rect {
        fill: var(--surface-primary);
        stroke: var(--border-primary);
        stroke-width: 1;
        clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%);
        filter: drop-shadow(0 0 2px var(--border-primary));
    }
}

.node1 {
    animation: nodeAppear 0.3s ease-out forwards;
    animation-delay: 0s;
}

.node2 {
    animation: nodeAppear 0.2s ease-out forwards;
    animation-delay: 0.05s;
}

.node3 {
    animation: nodeAppear 0.2s ease-out forwards;
    animation-delay: 0.3s;
}

.node4 {
    animation: nodeAppear 0.2s ease-out forwards;
    animation-delay: 0.55s;
}

.node5 {
    animation: nodeAppear 0.15s ease-out forwards;
    animation-delay: 0.75s;
}

.node6 {
    animation: nodeAppear 0.15s ease-out forwards;
    animation-delay: 0.75s;
}

.node7 {
    animation: nodeAppear 0.15s ease-out forwards;
    animation-delay: 0.95s;
}

.node8 {
    animation: nodeAppear 0.2s ease-out forwards;
    animation-delay: 1.4s;
}

.node9 {
    animation: nodeAppear 0.2s ease-out forwards;
    animation-delay: 1.75s;
}

.node10 {
    animation: nodeAppear 0.2s ease-out forwards;
    animation-delay: 0.3s;
}

.node11 {
    animation: nodeAppear 0.2s ease-out forwards;
    animation-delay: 0.55s;
}

.node12 {
    animation: nodeAppear 0.15s ease-out forwards;
    animation-delay: 0.75s;
}

.node13 {
    animation: nodeAppear 0.15s ease-out forwards;
    animation-delay: 0.75s;
}

.node14 {
    animation: nodeAppear 0.2s ease-out forwards;
    animation-delay: 0.3s;
}

.node15 {
    animation: nodeAppear 0.2s ease-out forwards;
    animation-delay: 0.55s;
}

.node16 {
    animation: nodeAppear 0.15s ease-out forwards;
    animation-delay: 0.75s;
}

.node17 {
    animation: nodeAppear 0.15s ease-out forwards;
    animation-delay: 0.75s;
}

.node18 {
    animation: nodeAppear 0.15s ease-out forwards;
    animation-delay: 0.95s;
}

.node19 {
    animation: nodeAppear 0.2s ease-out forwards;
    animation-delay: 1.4s;
}

.node20 {
    animation: nodeAppear 0.2s ease-out forwards;
    animation-delay: 1.75s;
}

.node21 {
    animation: nodeAppear 0.2s ease-out forwards;
    animation-delay: 2s;
}

.node22 {
    animation: nodeAppear 0.2s ease-out forwards;
    animation-delay: 2s;
}

.node23 {
    animation: nodeAppear 0.25s ease-out forwards;
    animation-delay: 2.4s;
}

.node24 {
    animation: nodeAppear 0.3s ease-out forwards;
    animation-delay: 2.75s;
}

// 6 Particules
.particle1,
.particle2,
.particle3,
.particle4,
.particle5,
.particle6 {
    opacity: 0;
    filter: drop-shadow(0 0 1px var(--border-primary));
}

.particle1 {
    animation: particleMain 5s ease-in-out infinite;
    animation-delay: 3.2s;
}

.particle2 {
    animation: particleTopTop 5.5s ease-in-out infinite;
    animation-delay: 3.4s;
}

.particle3 {
    animation: particleTopMid 5.3s ease-in-out infinite;
    animation-delay: 3.6s;
}

.particle4 {
    animation: particleMidTop 5.2s ease-in-out infinite;
    animation-delay: 3.8s;
}

.particle5 {
    animation: particleBotMid 5.4s ease-in-out infinite;
    animation-delay: 4s;
}

.particle6 {
    animation: particleBotBot 5.6s ease-in-out infinite;
    animation-delay: 4.2s;
}

// Animations
@keyframes drawBranch {
    to {
        stroke-dashoffset: 0;
        opacity: 0.25;
    }
}

@keyframes nodeAppear {
    0% {
        opacity: 0;
    }

    100% {
        opacity: 0.8;
    }
}

// Parcours particule voie milieu directe
@keyframes particleMain {
    0% {
        opacity: 0;
        cx: 12;
        cy: 50;
    }

    3% {
        opacity: 1;
    }

    97% {
        opacity: 1;
    }

    100% {
        opacity: 0;
        cx: 148;
        cy: 50;
    }
}

// Parcours voie haute - top top
@keyframes particleTopTop {
    0% {
        opacity: 0;
        cx: 12;
        cy: 50;
    }

    3% {
        opacity: 1;
    }

    15% {
        cx: 25;
        cy: 50;
    }

    25% {
        cx: 25;
        cy: 22;
    }

    35% {
        cx: 50;
        cy: 22;
    }

    42% {
        cx: 50;
        cy: 14;
    }

    52% {
        cx: 70;
        cy: 14;
    }

    58% {
        cx: 70;
        cy: 10;
    }

    68% {
        cx: 85;
        cy: 10;
    }

    75% {
        cx: 85;
        cy: 22;
    }

    80% {
        cx: 85;
        cy: 30;
    }

    85% {
        cx: 105;
        cy: 30;
    }

    88% {
        cx: 105;
        cy: 42;
    }

    92% {
        cx: 120;
        cy: 42;
    }

    95% {
        cx: 120;
        cy: 50;
    }

    97% {
        opacity: 1;
    }

    100% {
        opacity: 0;
        cx: 148;
        cy: 50;
    }
}

// Parcours voie haute - milieu
@keyframes particleTopMid {
    0% {
        opacity: 0;
        cx: 12;
        cy: 50;
    }

    3% {
        opacity: 1;
    }

    15% {
        cx: 25;
        cy: 50;
    }

    25% {
        cx: 25;
        cy: 22;
    }

    35% {
        cx: 50;
        cy: 22;
    }

    42% {
        cx: 50;
        cy: 30;
    }

    55% {
        cx: 70;
        cy: 30;
    }

    65% {
        cx: 85;
        cy: 30;
    }

    75% {
        cx: 105;
        cy: 30;
    }

    80% {
        cx: 105;
        cy: 42;
    }

    85% {
        cx: 120;
        cy: 42;
    }

    90% {
        cx: 120;
        cy: 50;
    }

    97% {
        opacity: 1;
    }

    100% {
        opacity: 0;
        cx: 148;
        cy: 50;
    }
}

// Parcours voie milieu - split haut
@keyframes particleMidTop {
    0% {
        opacity: 0;
        cx: 12;
        cy: 50;
    }

    3% {
        opacity: 1;
    }

    20% {
        cx: 25;
        cy: 50;
    }

    35% {
        cx: 45;
        cy: 50;
    }

    45% {
        cx: 65;
        cy: 50;
    }

    52% {
        cx: 65;
        cy: 42;
    }

    65% {
        cx: 85;
        cy: 42;
    }

    78% {
        cx: 105;
        cy: 42;
    }

    85% {
        cx: 120;
        cy: 42;
    }

    90% {
        cx: 120;
        cy: 50;
    }

    97% {
        opacity: 1;
    }

    100% {
        opacity: 0;
        cx: 148;
        cy: 50;
    }
}

// Parcours voie basse - milieu
@keyframes particleBotMid {
    0% {
        opacity: 0;
        cx: 12;
        cy: 50;
    }

    3% {
        opacity: 1;
    }

    15% {
        cx: 25;
        cy: 50;
    }

    25% {
        cx: 25;
        cy: 78;
    }

    35% {
        cx: 50;
        cy: 78;
    }

    42% {
        cx: 50;
        cy: 70;
    }

    55% {
        cx: 70;
        cy: 70;
    }

    65% {
        cx: 85;
        cy: 70;
    }

    75% {
        cx: 105;
        cy: 70;
    }

    80% {
        cx: 105;
        cy: 58;
    }

    85% {
        cx: 120;
        cy: 58;
    }

    90% {
        cx: 120;
        cy: 50;
    }

    97% {
        opacity: 1;
    }

    100% {
        opacity: 0;
        cx: 148;
        cy: 50;
    }
}

// Parcours voie basse - bottom bottom
@keyframes particleBotBot {
    0% {
        opacity: 0;
        cx: 12;
        cy: 50;
    }

    3% {
        opacity: 1;
    }

    15% {
        cx: 25;
        cy: 50;
    }

    25% {
        cx: 25;
        cy: 78;
    }

    35% {
        cx: 50;
        cy: 78;
    }

    42% {
        cx: 50;
        cy: 86;
    }

    52% {
        cx: 70;
        cy: 86;
    }

    58% {
        cx: 70;
        cy: 90;
    }

    68% {
        cx: 85;
        cy: 90;
    }

    75% {
        cx: 85;
        cy: 78;
    }

    80% {
        cx: 85;
        cy: 70;
    }

    85% {
        cx: 105;
        cy: 70;
    }

    88% {
        cx: 105;
        cy: 58;
    }

    92% {
        cx: 120;
        cy: 58;
    }

    95% {
        cx: 120;
        cy: 50;
    }

    97% {
        opacity: 1;
    }

    100% {
        opacity: 0;
        cx: 148;
        cy: 50;
    }
}